<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ZC Season 2026 â€” Quest Tracker</title>
  <style>
    :root{
      --bg0:#000;
      --bg1:#050507;
      --card:#0b0b10cc;
      --border:#24242c;
      --text:#f2f2f5;
      --muted:#a7a7b3;
      --soft:#cfcfda;
      --shadow: 0 10px 30px rgba(0,0,0,.45);
      --r:18px;
      --ok:#c8ffd6;
      --disabled:#7a7a86;

      /* Section identity */
      --mainA: rgba(255,255,255,.10);
      --mainB: rgba(255,255,255,.18);
      --sideA: rgba(180,120,255,.10);
      --sideB: rgba(180,120,255,.18);
      --hiddenA: rgba(255,190,110,.10);
      --hiddenB: rgba(255,190,110,.18);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background: radial-gradient(1200px 600px at 30% 10%, #1b1b2400, #000),
                  linear-gradient(180deg, var(--bg0), var(--bg1), var(--bg0));
      min-height:100vh;
    }
    a{color:var(--text)}
    .wrap{max-width:1280px; margin:0 auto; padding:24px 14px 56px}

    header{
      display:flex; gap:16px; justify-content:space-between; align-items:flex-end; flex-wrap:wrap;
      margin-bottom:14px;
    }
    .title h1{margin:0; font-size: clamp(20px, 2.2vw, 26px); letter-spacing:-.2px}
    .title .sub{
      margin-top:8px;
      color:var(--muted);
      font-size: clamp(12px, 1.2vw, 13px);
      max-width:860px;
      line-height:1.6
    }
    .btns{display:flex; gap:10px}
    button{
      border:1px solid var(--border);
      background: rgba(20,20,28,.5);
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      transition:.15s ease;
      user-select:none;
      font-size: 13px;
    }
    button:hover{background: rgba(30,30,42,.6)}
    button:active{transform: translateY(1px)}
    button:disabled{
      cursor:not-allowed;
      opacity:.5;
      color:var(--disabled);
    }

    /* RWD layout: desktop 3, tablet 2, mobile 1 */
    .grid3{
      display:grid;
      grid-template-columns: 1.05fr 1fr 1.05fr;
      gap:14px;
      margin-top:14px;
      align-items:start;
    }
    @media (max-width: 1080px){
      .grid3{grid-template-columns: 1fr 1fr;}
      .col-right{grid-column: 1 / -1;} /* Season Journey full width on tablet */
    }
    @media (max-width: 760px){
      .grid3{grid-template-columns: 1fr;}
      .col-right{grid-column: auto;}
      button{width:auto}
    }

    .card{
      border:1px solid var(--border);
      background: var(--card);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .head{
      display:flex; justify-content:space-between; align-items:center; gap:10px;
      padding:14px 16px;
      border-bottom:1px solid var(--border);
    }
    .card .head .h{
      font-weight:650;
      font-size:13px;
    }
    .badge{
      display:inline-flex; align-items:center; gap:6px;
      border:1px solid var(--border);
      background: rgba(10,10,16,.5);
      padding:2px 8px;
      border-radius:999px;
      font-size:11px;
      color:#cfcfda;
      white-space:nowrap;
    }
    .muted{color:var(--muted); font-size:12px}
    .small{font-size:12px}
    .card .body{padding:16px}

    .row{display:flex; justify-content:space-between; gap:10px; align-items:center;}
    .progress{
      height:8px;
      background: rgba(255,255,255,.08);
      border-radius:999px;
      overflow:hidden;
      margin-top:8px;
      border:1px solid rgba(255,255,255,.06);
    }
    .progress > div{
      height:100%;
      width:0%;
      background: rgba(255,255,255,.75);
      transition: width .25s ease;
    }

    /* Quest sections (more distinct) */
    .sectionBlock{
      border:1px solid var(--border);
      border-radius:16px;
      overflow:hidden;
      margin-top:14px;
      background: rgba(0,0,0,.15);
    }
    .sectionHeader{
      padding:10px 12px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      border-bottom:1px solid rgba(255,255,255,.06);
      font-size:12px;
      font-weight:650;
      letter-spacing:.2px;
    }
    .sectionHeader .hint{font-weight:500; color:var(--muted); font-size:12px}
    .sectionHeader.main{background: linear-gradient(90deg, var(--mainA), transparent); border-left:3px solid var(--mainB);}
    .sectionHeader.side{background: linear-gradient(90deg, var(--sideA), transparent); border-left:3px solid var(--sideB);}
    .sectionHeader.hidden{background: linear-gradient(90deg, var(--hiddenA), transparent); border-left:3px solid var(--hiddenB);}

    .questList{display:flex; flex-direction:column; gap:10px; padding:12px;}
    .quest{
      width:100%;
      border:1px solid var(--border);
      background: rgba(10,10,14,.45);
      border-radius: 16px;
      padding:12px;
      display:flex;
      gap:12px;
      align-items:flex-start;
      cursor:pointer;
      transition:.15s ease;
      text-align:left;
    }
    .quest:hover{background: rgba(20,20,28,.55)}
    .quest.active{border-color: rgba(255,255,255,.25); background: rgba(255,255,255,.06)}
    .check{
      width:40px; min-width:40px; height:40px;
      display:grid; place-items:center;
      border-radius:12px;
      border:1px solid var(--border);
      background: rgba(20,20,28,.35);
      font-size:18px;
      user-select:none;
    }
    .quest .meta{flex:1; min-width:0}
    .quest .t{
      font-weight:650; font-size:13px; line-height:1.35;
      display:flex; flex-wrap:wrap; gap:8px; align-items:center;
    }
    .quest .d{
      margin-top:6px;
      color:var(--muted);
      font-size:12px;
      line-height:1.45;
      display:-webkit-box; -webkit-line-clamp:2; -webkit-box-orient:vertical; overflow:hidden;
    }

    /* Showcase */
    textarea, input{
      width:100%;
      border:1px solid var(--border);
      background: rgba(0,0,0,.35);
      color: var(--text);
      border-radius: 14px;
      padding:10px 12px;
      outline:none;
      font-size:13px;
    }
    textarea{min-height:120px; resize:vertical}
    input:focus, textarea:focus{border-color: rgba(255,255,255,.25)}
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:8px}
    .two{display:grid; grid-template-columns:1fr 1fr; gap:12px}
    @media (max-width: 860px){ .two{grid-template-columns:1fr} }

    audio, video{width:100%; border-radius:12px}
    .mediaBox{
      border:1px solid var(--border);
      background: rgba(10,10,14,.4);
      border-radius: 16px;
      padding:12px;
      margin-top:10px;
    }
    .mediaHead{
      display:flex; align-items:center; gap:8px; justify-content:space-between;
      margin-bottom:10px;
    }
    .truncate{max-width: 70%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; color:var(--muted); font-size:12px}

    /* External links list */
    .linkRow{display:flex; gap:10px; align-items:center; margin-top:10px; flex-wrap:wrap}
    .linkRow input{flex:1; min-width: 200px;}
    .linkItem{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      border-radius:14px;
      padding:10px 12px;
      margin-top:8px;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    .linkItem .left{min-width:0; flex:1}
    .linkItem .name{font-size:12px; font-weight:650}
    .linkItem .url{
      font-size:12px; color:var(--muted);
      overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
      max-width: 520px;
    }
    .miniBtn{
      padding:8px 10px;
      border-radius:12px;
      font-size:12px;
      white-space:nowrap;
    }

    /* Season Journey */
    .chapter{
      border:1px solid var(--border);
      background: rgba(10,10,14,.4);
      border-radius:16px;
      padding:12px;
      margin-top:10px;
    }
    .chapterTop{
      display:flex; justify-content:space-between; align-items:flex-start; gap:10px;
      flex-wrap:wrap;
    }
    .chapterTitle{font-weight:650; font-size:13px}
    .goal{
      display:flex; gap:10px; align-items:flex-start;
      padding:8px 0;
      border-bottom:1px dashed rgba(255,255,255,.06);
    }
    .goal:last-child{border-bottom:none}
    .goal .gcheck{
      width:26px; height:26px; border-radius:10px;
      border:1px solid var(--border);
      background: rgba(20,20,28,.35);
      display:grid; place-items:center;
      cursor:pointer;
      user-select:none;
      font-size:14px;
      margin-top:1px;
    }
    .goal .gtext{flex:1; font-size:12px; color:var(--soft); line-height:1.45}
    .goal.done .gtext{color: var(--ok)}
    .chapterFoot{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      margin-top:10px;
      flex-wrap:wrap;
    }

    /* Modal */
    .modalBack{
      position:fixed; inset:0;
      background: rgba(0,0,0,.72);
      display:none;
      align-items:center; justify-content:center;
      padding:16px;
      z-index:50;
    }
    .modal{
      width: min(680px, 100%);
      border:1px solid var(--border);
      background: #05050a;
      border-radius: 18px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .modal .mhead{
      padding:14px 16px;
      border-bottom:1px solid var(--border);
      display:flex; justify-content:space-between; align-items:center; gap:10px;
    }
    .modal .mbody{padding:16px}
    .lootItem{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      border-radius: 14px;
      padding:12px 14px;
      display:flex; justify-content:space-between; gap:10px; align-items:center;
      margin-top:10px;
      font-size:13px;
    }

    footer{
      margin-top:18px;
      color: var(--muted);
      font-size:12px;
      display:flex; justify-content:space-between; gap:10px; flex-wrap:wrap;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">
        <div class="muted">ZC Season 2026</div>
        <h1>World Under Construction : Taipei Low-Frequency</h1>
        <div class="sub">
          é€™ä¸æ˜¯èµ·é»ï¼Œä¹Ÿä¸æ˜¯çµ‚é»ï¼Œè€Œæ˜¯ä¸€åº§ä»åœ¨é‹è½‰çš„åŸå¸‚é‚Šç·£ã€‚æŠŠæƒ…ç·’å®‰ç½®åœ¨ç¯€å¥è£¡ï¼Œè®“ä¸–ç•ŒæŒçºŒè¢«æ„ŸçŸ¥ã€‚
        </div>
      </div>
      <div class="btns">
        <button id="exportBtn">â¬‡ åŒ¯å‡º progress.json</button>
        <button id="resetBtn" title="Reset">âœ¨çœ‹æœ€æ–°é€²åº¦âœ¨</button>
      </div>
    </header>

    <div class="grid3">
      <!-- LEFT -->
      <div class="card">
        <div class="head">
          <div class="h">ä»»å‹™åˆ—è¡¨ï¼ˆQuest Boardï¼‰</div>
          <div class="badge">ä¸»ç·š / æ”¯ç·š</div>
        </div>
        <div class="body">
          <div class="row">
            <div class="muted">ä»»å‹™å®Œæˆ</div>
            <div class="muted"><span id="doneCount">0</span>/<span id="questCount">0</span></div>
          </div>
          <div class="progress"><div id="questBar"></div></div>

          <div class="sectionBlock">
            <div class="sectionHeader main">
              <div>MAIN QUEST</div>
              <div class="hint">ä¸–ç•Œèƒ½é‡æ ¸å¿ƒ</div>
            </div>
            <div class="questList" id="mainList"></div>
          </div>

          <div class="sectionBlock">
            <div class="sectionHeader side">
              <div>SIDE QUESTS</div>
              <div class="hint">æ¨¡çµ„åŒ–æ¨é€²</div>
            </div>
            <div class="questList" id="sideList"></div>
          </div>

          <div class="sectionBlock">
            <div class="sectionHeader hidden">
              <div>HIDDEN</div>
              <div class="hint">åªå°ä½ è² è²¬</div>
            </div>
            <div class="questList" id="hiddenList"></div>
          </div>
        </div>
      </div>

      <!-- MIDDLE -->
      <div class="card">
        <div class="head">
          <div class="h">ä»»å‹™å®Œæˆæ¨£è²Œï¼ˆShowcaseï¼‰</div>
          <div class="badge" id="selectedBadge">â€”</div>
        </div>
        <div class="body" id="showcaseBox"></div>
      </div>

      <!-- RIGHT -->
      <div class="card col-right">
        <div class="head">
          <div class="h">è³½å­£æ—…ç¨‹ï¼ˆSeason Journeyï¼‰</div>
          <div class="badge">å¯å‹¾é¸ + ç« ç¯€ç¦®åŒ…</div>
        </div>
        <div class="body" id="journeyBox"></div>
      </div>
    </div>

    <footer>
      <div>â“’ ZC Season 2026 â€” The Audio Architect Â· Taipeiï¼ˆè³‡æ–™å„²å­˜åœ¨ localStorageï¼‰</div>
      <div style="display:flex; gap:8px; flex-wrap:wrap">
        <span class="badge">Hazard Orange</span>
        <span class="badge">Bioluminescent Purple</span>
        <span class="badge">Mist White</span>
      </div>
    </footer>
  </div>

  <!-- Loot Modal -->
  <div class="modalBack" id="modalBack">
    <div class="modal">
      <div class="mhead">
        <div>
          <div style="font-weight:650; font-size:13px">Loot Drop</div>
          <div class="muted" style="margin-top:4px; font-size:12px" id="lootSubtitle">éš¨æ©ŸæŠ½å‡º 3 é …çå‹µ</div>
        </div>
        <button id="closeModal">é—œé–‰</button>
      </div>
      <div class="mbody" id="lootItems"></div>
    </div>
  </div>

<script>
  const STORAGE_KEY = "zc_season_2026_html_v3";

  const PRESET_REWARDS = [
    "Hazard Orange Glow Badge",
    "Bioluminescent Purple Frame",
    "Taipei Coordinates Title",
    "World Keyword Booster (+10 words)",
    "Mixtape Cover Template",
    "Reels Hook Line Pack (x5)",
    "Sound Relic Slot (+2)",
    "Studio Light Preset",
    "Glitch Texture Overlay",
    "Cinematic Fog LUT",
    "Lore Naming Rule Upgrade",
    "Collab Outreach Script",
    "Foreign Label Pitch Sheet",
    "Performance Ritual Checklist",
    "Theatre Scene Prompt",
    "Sample Pack Naming Stamp",
    "Audience Shelter Caption Pack",
    "World State Tag Set",
    "Energy Core Progress Charm",
    "Archive Index Card",
    "Encrypted Signal Token (jyi4uqp3)"
  ];

  const QUESTS = [
    { id:"mainquest-core", type:"main", title:"ä¸»ç·šï½œèƒ½é‡æ ¸å¿ƒï¼šå°åŒ—æ–½å·¥ä¸­ï¼ˆThe Core is Runningï¼‰",
      description:"å®Œæˆä¸–ç•Œè§€æˆç«‹ã€è²éŸ³ç³»çµ±æˆç«‹ã€ä¸–ç•Œè¢«æ„ŸçŸ¥ï¼ˆå¤–éƒ¨é©—è­‰ + å‚³æ’­ + è½åœ°ï¼‰ã€‚" },

    { id:"q01-lore-foundation", type:"side", title:"01ï½œèªå½™åœ°åŸºï¼šå°åŒ—åº§æ¨™æ ¡æº–ï¼ˆLore Foundationï¼‰",
      description:"ä¸–ç•Œç”¨èªè¦ç¯„ã€å›ºå®šå®£è¨€å¥å‹ã€å‘½åè¦å‰‡ã€100 é—œéµè©ã€‚" },

    { id:"q02-sound-construction", type:"side", title:"02ï½œæ®˜éª¸é‡æ§‹ï¼šè²éŸ³å»ºç¯‰æ–½å·¥ï¼ˆSound Constructionï¼‰",
      description:"demo â†’ ä¸–ç•Œç¢ç‰‡ï¼ˆ1â€“2 åˆ†ï¼‰ä¸¦å¯ç”¨æ–¼çŸ­å½±éŸ³ã€‚" },

    { id:"q03-visual-biome", type:"side", title:"03ï½œè¦–è¦ºåœ°æ™¯ï¼šå»¢å¢Ÿèˆ‡æœ‰æ©Ÿç‰©å…±å­˜ï¼ˆVisual Biomeï¼‰",
      description:"ä¸‰ç¨®å›ºå®šå ´æ™¯ï¼ˆå°åŒ—ç¸«éš™/å·¥æ¥­éºè·¡/æ¼‚æµ®æœ‰æ©Ÿï¼‰+ è‰²ç›¤/å…‰å½±ä¸€è‡´ã€‚" },

    { id:"q04-signal-transmission", type:"side", title:"04ï½œè¨Šè™Ÿå‚³è¼¸ï¼šä½é »ä»åœ¨åœ°åº•é‹è½‰ï¼ˆSignal Transmissionï¼‰",
      description:"æ¯é€± Reels/Short ç©©å®šå‡ºç¾ï¼Œå›ºå®šä¸–ç•Œå®£å‘Šå¼é–‹é ­ã€‚" },

    { id:"q05-emotion-shelter", type:"side", title:"05ï½œæƒ…ç·’å®‰ç½®ï¼šäººé¡ç—•è·¡äº‹ä»¶ï¼ˆEmotion Shelterï¼‰",
      description:"ä¸æ¨å»£çš„æƒ…ç·’/ç”Ÿæ´»å…§å®¹ï¼Œè®“è§€çœ¾èƒ½æŠŠæƒ…ç·’æ”¾åœ¨ä½ çš„ç¯€å¥è£¡ã€‚" },

    { id:"q06-voices-from-ruins", type:"side", title:"06ï½œè²ç·šäº¤æœƒï¼šæœ‰æ©Ÿç”Ÿå‘½é«”ä¾†è¨ªï¼ˆ6 ä½åˆä½œï¼‰",
      description:"èˆ‡ 6 ä½æ­Œæ‰‹/è—è¡“å®¶åˆä½œï¼Œè‡³å°‘ 3 ä½å…¬é–‹ç™¼ä½ˆæˆæœã€‚" },

    { id:"q07-foreign-signal-release", type:"side", title:"07ï½œåœ‹éš›åº§æ¨™ï¼šå¤–éƒ¨å» ç‰Œæ‰¿èªï¼ˆ3 é¦–åœ‹å¤–ç™¼è¡Œï¼‰",
      description:"åœ¨åœ‹å¤–å» ç‰Œç™¼è¡Œ 3 é¦–å–®æ›²ï¼Œå®ŒæˆæŠ•éâ†’å°é½Šâ†’ç™¼è¡Œâ†’æ“´æ•£ã€‚" },

    { id:"q08-zchuan-sample-pack", type:"side", title:"08ï½œå·¥å…·é›é€ ï¼šzchuan Sample Pack",
      description:"Drums/FX/Texture/Vox/Atmosï¼Œå…¨éƒ¨ç”¨ä¸–ç•Œèªå½™å‘½åã€‚" },

    { id:"q09-music-theatre", type:"side", title:"09ï½œèˆå°æ•˜äº‹ï¼šé›»å­éŸ³æ¨‚åŠ‡ï¼ˆElectronic Music Theatreï¼‰",
      description:"å®Œæˆä¸€å ´é›»å­éŸ³æ¨‚åŠ‡ï¼šåŠ‡æƒ…ç·š + è¦–è¦ºæ•˜äº‹ + éŸ³æ¨‚ç‚ºæ•˜äº‹æ ¸å¿ƒã€‚" },

    { id:"q10-six-location-ritual", type:"side", title:"10ï½œå ´åŸŸå„€å¼ï¼šå…­åœ°é»ç²¾å¿ƒç·¨æ’æ¼”å‡ºï¼ˆSix Location Ritualï¼‰",
      description:"åœ¨ 6 å€‹ä¸åŒå ´åŸŸå®Œæˆç²¾å¿ƒç·¨æ’æ¼”å‡ºã€‚" },

    { id:"q11-mixtape-archive", type:"side", title:"11ï½œæ™‚é–“å»¶å±•ï¼šYouTube DJ Mixtape æª”æ¡ˆé¤¨ï¼ˆ8 æ”¯ï¼‰",
      description:"8 æ”¯ Mixtapeï¼Œæ¯æ”¯éƒ½æ˜¯ä¸€å€‹ World Stateã€‚" },

    { id:"q12-origin-base", type:"side", title:"12ï½œå‡ºç”Ÿåœ°å»ºè¨­ï¼šå·¥ä½œå®¤è£æ½¢ï¼†ç‰‡å ´å»ºæ§‹ï¼ˆOrigin Baseï¼‰",
      description:"å®Œæˆè£æ½¢èˆ‡ç‰‡å ´ï¼Œè‡³å°‘ 5 æ”¯å…§å®¹åœ¨æ­¤æ‹æ”ã€‚" },

    { id:"q-hidden-jyi4uqp3", type:"hidden", title:"éš±è—ï½œjyi4uqp3ï¼ˆEncrypted Signalï¼‰",
      description:"ä¸å° KPI è§£é‡‹ï¼Œåªå°ä½ è² è²¬ã€‚å¯ä¸å…¬é–‹ï¼Œä½†å¿…é ˆå®Œæˆã€‚" },
  ];

  const JOURNEY = [
    { id:"c1", title:"Chapter Iï½œä½é »ç”¦é†’ï¼ˆCore Bootï¼‰", goals:[
      "å®Œæˆä¸–ç•Œå®£è¨€ï¼ˆä¸­è‹±å¯ç”¨ï¼‰","èªå½™åœ°åŸºï¼šæœ€å°å¯è¡Œç‰ˆæœ¬","ç™¼å¸ƒ 1 å‰‡æ–½å·¥ç´€éŒ„çŸ­å½±éŸ³"
    ]},
    { id:"c2", title:"Chapter IIï½œåœ°åŸºæ–½å·¥ï¼ˆFoundation Laidï¼‰", goals:[
      "è²éŸ³æ®˜éª¸ â‰¥5 æ®µ","è¦–è¦ºåœ°æ™¯ â‰¥2 å ´æ™¯","å·¥ä½œå®¤/ç‰‡å ´è—åœ–åˆç¨¿"
    ]},
    { id:"c3", title:"Chapter IIIï½œåŸå¸‚ç¸«éš™æ”¾é€ï¼ˆTaipei Transmissionï¼‰", goals:[
      "çŸ­å½±éŸ³æ¯é€±é”æ¨™","YouTube Mixtape 1â€“2 æ”¯","æƒ…ç·’å®‰ç½®è²¼æ–‡ â‰¥2"
    ]},
    { id:"c4", title:"Chapter IVï½œæœ‰æ©Ÿç”Ÿé•·ï¼ˆBioluminescent Growthï¼‰", goals:[
      "åˆä½œè—è¡“å®¶é”æˆ 2 ä½","Sample Pack é€²åº¦ â‰¥30%","è¦–è¦ºæ¨¡æ¿å›ºå®šåŒ–ï¼ˆå‘½å/è‰²ç›¤/å­—å¹•ï¼‰"
    ]},
    { id:"c5", title:"Chapter Vï½œä¸–ç•Œäº¤æœƒï¼ˆCollisionï¼‰", goals:[
      "è‡³å°‘ 1 é¦–åœ‹å¤–å» ç‰Œç™¼è¡Œæˆ–ç°½ç´„ç¢ºèª","å ´åŸŸæ¼”å‡ºå®Œæˆ 2â€“3 å ´","åˆä½œæˆæœå…¬é–‹ï¼ˆBTS / Snippetï¼‰"
    ]},
    { id:"c6", title:"Chapter VIï½œæ™‚é–“å¾ªç’°ï¼ˆArchiveï¼‰", goals:[
      "Mixtape ç´¯ç© â‰¥5","ç‰‡å ´å•Ÿç”¨å…§å®¹ â‰¥3","Sample Pack é€²åº¦ â‰¥60%"
    ]},
    { id:"c7", title:"Finalï½œä¸–ç•Œä»åœ¨æ–½å·¥ï¼Œä½†å·²èƒ½å®‰ç½®æƒ…ç·’ï¼ˆShelter Builtï¼‰", goals:[
      "3 é¦–åœ‹å¤–å» ç‰Œç™¼è¡Œ","6 ä½åˆä½œé”æˆ","é›»å­éŸ³æ¨‚åŠ‡å®Œæˆ","jyi4uqp3 å®Œæˆï¼ˆå¯ä¸å…¬é–‹ï¼‰"
    ]},
  ];

  const state = {
    selectedId: QUESTS[0].id,
    completed: {},
    showcase: {},       // { [questId]: { text, audioUrl, videoUrl, links:[{name,url}] } }
    journeyChecks: {},  // { [chapterId]: [bool...] }
    chapterLootHistory: {} // { [chapterId]: [{at, items}] }
  };

  function $(id){ return document.getElementById(id); }
  function escapeHtml(str){
    return (str||"").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;");
  }
  function uniquePick(arr, k){
    const copy = arr.slice(), out=[];
    while(out.length<k && copy.length){
      const idx = Math.floor(Math.random()*copy.length);
      out.push(copy.splice(idx,1)[0]);
    }
    return out;
  }
  function getYouTubeEmbed(url){
    if(!url) return null;
    try{
      const u = new URL(url);
      const host = u.hostname.replace("www.","");
      if(host==="youtu.be"){
        const id = u.pathname.replace("/","");
        return id ? `https://www.youtube.com/embed/${id}` : null;
      }
      if(host==="youtube.com" || host==="m.youtube.com"){
        const id = u.searchParams.get("v");
        return id ? `https://www.youtube.com/embed/${id}` : null;
      }
      return null;
    }catch{ return null; }
  }
  function ensureShowcase(qid){
    if(!state.showcase[qid]){
      state.showcase[qid] = { text:"", audioUrl:"", videoUrl:"", links:[] };
    } else {
      state.showcase[qid].links = state.showcase[qid].links || [];
    }
    return state.showcase[qid];
  }
  function ensureJourneyChapter(chId, goalLen){
    if(!state.journeyChecks[chId] || state.journeyChecks[chId].length !== goalLen){
      state.journeyChecks[chId] = Array(goalLen).fill(false);
    }
    return state.journeyChecks[chId];
  }

  function load(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw) return;
      const s = JSON.parse(raw);
      Object.assign(state, s || {});
    }catch{}
  }
  function save(){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  }

  function renderQuestCompletion(){
    const done = QUESTS.filter(q=>state.completed[q.id]).length;
    $("doneCount").textContent = done;
    $("questCount").textContent = QUESTS.length;
    $("questBar").style.width = ((done/QUESTS.length)*100).toFixed(0) + "%";
  }

  function questItemHTML(q){
    const done = !!state.completed[q.id];
    const active = state.selectedId === q.id;
    const check = done ? "âœ…" : "â¬œ";
    return `
      <div class="quest ${active?'active':''}" data-qid="${q.id}">
        <div class="check" data-toggle="${q.id}" title="åˆ‡æ›å®Œæˆç‹€æ…‹">${check}</div>
        <div class="meta">
          <div class="t"><span>${escapeHtml(q.title)}</span></div>
          <div class="d">${escapeHtml(q.description)}</div>
        </div>
      </div>
    `;
  }

  function bindQuestListClicks(container){
    container.querySelectorAll(".quest").forEach(el=>{
      el.addEventListener("click", (e)=>{
        const qid = el.getAttribute("data-qid");
        const toggle = e.target && e.target.getAttribute && e.target.getAttribute("data-toggle");
        if(toggle){
          state.completed[toggle] = !state.completed[toggle];
          save(); renderAll();
          return;
        }
        state.selectedId = qid;
        save(); renderAll();
      });
    });
  }

  function renderQuestLists(){
    const main = QUESTS.filter(q=>q.type==="main");
    const side = QUESTS.filter(q=>q.type==="side");
    const hidden = QUESTS.filter(q=>q.type==="hidden");

    $("mainList").innerHTML = main.map(questItemHTML).join("");
    $("sideList").innerHTML = side.map(questItemHTML).join("");
    $("hiddenList").innerHTML = hidden.map(questItemHTML).join("");

    bindQuestListClicks($("mainList"));
    bindQuestListClicks($("sideList"));
    bindQuestListClicks($("hiddenList"));
  }

  function renderShowcase(){
    const q = QUESTS.find(x=>x.id===state.selectedId) || QUESTS[0];
    $("selectedBadge").textContent = q.title.slice(0, 16) + (q.title.length>16 ? "â€¦" : "");
    const sc = ensureShowcase(q.id);
    const yt = getYouTubeEmbed(sc.videoUrl);

    const audioBlock = sc.audioUrl ? `
      <div class="mediaBox">
        <div class="mediaHead">
          <span class="badge">Audio</span>
          <a class="truncate" href="${escapeHtml(sc.audioUrl)}" target="_blank" rel="noreferrer">${escapeHtml(sc.audioUrl)}</a>
        </div>
        <audio controls src="${escapeHtml(sc.audioUrl)}"></audio>
      </div>` : "";

    const videoBlock = sc.videoUrl ? `
      <div class="mediaBox">
        <div class="mediaHead">
          <span class="badge">Video</span>
          <a class="truncate" href="${escapeHtml(sc.videoUrl)}" target="_blank" rel="noreferrer">${escapeHtml(sc.videoUrl)}</a>
        </div>
        ${
          yt
          ? `<div style="border:1px solid var(--border); border-radius:14px; overflow:hidden; background:#000">
               <iframe width="100%" height="360" src="${yt}" title="YouTube" frameborder="0"
                 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
             </div>`
          : `<video controls src="${escapeHtml(sc.videoUrl)}"></video>`
        }
      </div>` : "";

    const linksHTML = (sc.links||[]).map((lnk, idx)=>`
      <div class="linkItem">
        <div class="left">
          <div class="name">${escapeHtml(lnk.name || "External Link")}</div>
          <div class="url">${escapeHtml(lnk.url || "")}</div>
        </div>
        <div style="display:flex; gap:8px; align-items:center">
          <a class="badge" href="${escapeHtml(lnk.url||"#")}" target="_blank" rel="noreferrer">Open</a>
          <button class="miniBtn" data-del-link="${idx}">åˆªé™¤</button>
        </div>
      </div>
    `).join("");

    $("showcaseBox").innerHTML = `
      <div class="mediaBox" style="margin-top:0">
        <div style="font-weight:650; font-size:13px">${escapeHtml(q.title)}</div>
        <div class="muted" style="margin-top:6px; line-height:1.5">${escapeHtml(q.description)}</div>
        <div style="display:flex; gap:8px; flex-wrap:wrap; margin-top:10px">
          <span class="badge">${state.completed[q.id] ? "å·²å®Œæˆ" : "æœªå®Œæˆ"}</span>
        </div>
      </div>

      <!-- removed the label line; keep textarea for narrative -->
      <div style="margin-top:14px">
        <textarea id="scText" placeholder="å®Œæˆç´€éŒ„ï¼ˆä¸–ç•Œæ•˜äº‹ / ä½ æƒ³ç•™çš„è©±ï¼‰">${escapeHtml(sc.text)}</textarea>
      </div>

      <div class="two" style="margin-top:12px">
        <div>
          <label>éŸ³é »é€£çµï¼ˆAudio URLï¼‰</label>
          <input id="scAudio" placeholder="https://.../audio.mp3" value="${escapeHtml(sc.audioUrl)}" />
          <div class="muted small" style="margin-top:6px"></div>
        </div>
        <div>
          <label>å½±ç‰‡é€£çµï¼ˆVideo URL æˆ– YouTubeï¼‰</label>
          <input id="scVideo" placeholder="https://.../video.mp4 æˆ– https://youtu.be/xxxx" value="${escapeHtml(sc.videoUrl)}" />
          <div class="muted small" style="margin-top:6px"></div>
        </div>
      </div>

      ${audioBlock}
      ${videoBlock}

      <div class="mediaBox">
        

        <div class="linkRow">
          <input id="linkName" placeholder="é€£çµåç¨±ï¼ˆä¾‹ï¼šSpotify Release / IG Reel / Demo Folderï¼‰" />
          <input id="linkUrl" placeholder="URL" />
          <button id="addLinkBtn" class="miniBtn">æ–°å¢</button>
        </div>

        <div id="linkList">${linksHTML || `<div class="muted" style="margin-top:10px"></div>`}</div>
      </div>

      <div class="mediaBox">
        <div class="row">
          <div class="muted">æç¤ºï¼šä½ å¯ä»¥å…ˆå®Œæˆ 2 â†’ åˆ‡ 1 â†’ å†æ¨ 3ï¼Œä»»å‹™å…è¨±äº¤éŒ¯ã€‚</div>
          <button id="toggleSelected">${state.completed[q.id] ? "æ¨™è¨˜ç‚ºæœªå®Œæˆ" : "æ¨™è¨˜ç‚ºå®Œæˆ"}</button>
        </div>
      </div>
    `;

    $("scText").addEventListener("input", (e)=>{ sc.text = e.target.value; save(); });
    $("scAudio").addEventListener("input", (e)=>{ sc.audioUrl = e.target.value.trim(); save(); });
    $("scVideo").addEventListener("input", (e)=>{ sc.videoUrl = e.target.value.trim(); save(); });

    $("toggleSelected").addEventListener("click", ()=>{
      state.completed[q.id] = !state.completed[q.id];
      save(); renderAll();
    });

    $("addLinkBtn").addEventListener("click", ()=>{
      const name = ($("linkName").value || "").trim();
      const url = ($("linkUrl").value || "").trim();
      if(!url){ alert("è«‹è¼¸å…¥ URL"); return; }
      sc.links = sc.links || [];
      sc.links.push({ name: name || "External Link", url });
      $("linkName").value = "";
      $("linkUrl").value = "";
      save(); renderShowcase();
    });

    $("linkList").querySelectorAll("[data-del-link]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const idx = Number(btn.getAttribute("data-del-link"));
        sc.links.splice(idx, 1);
        save(); renderShowcase();
      });
    });
  }

  function renderJourney(){
    const box = $("journeyBox");
    box.innerHTML = JOURNEY.map(ch=>{
      const checks = ensureJourneyChapter(ch.id, ch.goals.length);
      const doneCount = checks.filter(Boolean).length;
      const chapterDone = doneCount === ch.goals.length;

      const goalsHTML = ch.goals.map((g, i)=>{
        const done = !!checks[i];
        return `
          <div class="goal ${done?'done':''}" data-ch="${ch.id}" data-idx="${i}">
            <div class="gcheck" title="åˆ‡æ›å®Œæˆ">${done ? "âœ“" : ""}</div>
            <div class="gtext">${escapeHtml(g)}</div>
          </div>
        `;
      }).join("");

      return `
        <div class="chapter">
          <div class="chapterTop">
            <div>
              <div class="chapterTitle">${escapeHtml(ch.title)}</div>
              <div class="muted" style="margin-top:6px">${doneCount}/${ch.goals.length} å·²å®Œæˆ</div>
              <div class="progress" style="margin-top:10px"><div style="width:${(doneCount/ch.goals.length)*100}%"></div></div>
            </div>
            <div style="display:flex; flex-direction:column; gap:8px; align-items:flex-end">
              <span class="badge">${chapterDone ? "ç« ç¯€å®Œæˆ" : "æ–½å·¥ä¸­"}</span>
              <button class="miniBtn" data-loot-ch="${ch.id}" ${chapterDone ? "" : "disabled"}>ğŸ ç« ç¯€ç¦®åŒ…</button>
            </div>
          </div>
          <div style="margin-top:10px">${goalsHTML}</div>
        </div>
      `;
    }).join("");

    box.querySelectorAll(".goal").forEach(el=>{
      el.addEventListener("click", ()=>{
        const chId = el.getAttribute("data-ch");
        const idx = Number(el.getAttribute("data-idx"));
        const arr = ensureJourneyChapter(chId, JOURNEY.find(x=>x.id===chId).goals.length);
        arr[idx] = !arr[idx];
        save(); renderJourney();
      });
    });

    box.querySelectorAll("[data-loot-ch]").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        const chId = btn.getAttribute("data-loot-ch");
        openChapterLoot(chId);
      });
    });
  }

  function openChapterLoot(chId){
    const items = uniquePick(PRESET_REWARDS, 3);
    if(!state.chapterLootHistory[chId]) state.chapterLootHistory[chId] = [];
    state.chapterLootHistory[chId].unshift({ at: new Date().toISOString(), items });
    state.chapterLootHistory[chId] = state.chapterLootHistory[chId].slice(0, 10);
    save();

    const chapterTitle = (JOURNEY.find(c=>c.id===chId)?.title) || "Chapter Loot";
    $("lootSubtitle").textContent = `${chapterTitle}ï½œéš¨æ©ŸæŠ½å‡º 3 é …çå‹µ`;

    $("lootItems").innerHTML = `
      <div class="muted">æœ¬æ¬¡æ‰è½ï¼š</div>
      ${items.map(it=>`<div class="lootItem"><div>${escapeHtml(it)}</div><span class="badge">Reward</span></div>`).join("")}
      <div class="mediaBox">
        <div style="font-weight:650; font-size:13px">æœ¬ç« ç¯€æŠ½å–ç´€éŒ„ï¼ˆæœ€è¿‘ 10 æ¬¡ï¼‰</div>
        ${(state.chapterLootHistory[chId]||[]).map(h=>{
          const t = new Date(h.at).toLocaleString();
          const lis = h.items.map(x=>`<div class="small">â€¢ ${escapeHtml(x)}</div>`).join("");
          return `<div class="mediaBox" style="margin-top:10px">
              <div class="muted">${escapeHtml(t)}</div>
              <div style="margin-top:8px">${lis}</div>
            </div>`;
        }).join("")}
      </div>
    `;

    $("modalBack").style.display = "flex";
  }

  function closeModal(){ $("modalBack").style.display = "none"; }

  function renderAll(){
    renderQuestCompletion();
    renderQuestLists();
    renderShowcase();
    renderJourney();
  }

  function renderQuestLists(){
    const main = QUESTS.filter(q=>q.type==="main");
    const side = QUESTS.filter(q=>q.type==="side");
    const hidden = QUESTS.filter(q=>q.type==="hidden");

    $("mainList").innerHTML = main.map(questItemHTML).join("");
    $("sideList").innerHTML = side.map(questItemHTML).join("");
    $("hiddenList").innerHTML = hidden.map(questItemHTML).join("");

    bindQuestListClicks($("mainList"));
    bindQuestListClicks($("sideList"));
    bindQuestListClicks($("hiddenList"));
  }

  function questItemHTML(q){
    const done = !!state.completed[q.id];
    const active = state.selectedId === q.id;
    const check = done ? "âœ…" : "â¬œ";
    return `
      <div class="quest ${active?'active':''}" data-qid="${q.id}">
        <div class="check" data-toggle="${q.id}" title="åˆ‡æ›å®Œæˆç‹€æ…‹">${check}</div>
        <div class="meta">
          <div class="t"><span>${escapeHtml(q.title)}</span></div>
          <div class="d">${escapeHtml(q.description)}</div>
        </div>
      </div>
    `;
  }

  function bindQuestListClicks(container){
    container.querySelectorAll(".quest").forEach(el=>{
      el.addEventListener("click", (e)=>{
        const qid = el.getAttribute("data-qid");
        const toggle = e.target && e.target.getAttribute && e.target.getAttribute("data-toggle");
        if(toggle){
          state.completed[toggle] = !state.completed[toggle];
          save(); renderAll();
          return;
        }
        state.selectedId = qid;
        save(); renderAll();
      });
    });
  }

  $("closeModal").addEventListener("click", closeModal);
  $("modalBack").addEventListener("click", (e)=>{
    if(e.target === $("modalBack")) closeModal();
  });

  $("resetBtn").addEventListener("click", ()=>{
    if(!confirm("ç¢ºå®šè¦é‡ç½®æ‰€æœ‰é€²åº¦èˆ‡ç´€éŒ„ï¼Ÿ")) return;
    localStorage.removeItem(STORAGE_KEY);
    location.reload();
  });

  load();
  JOURNEY.forEach(ch=>ensureJourneyChapter(ch.id, ch.goals.length));
  renderAll();


  let READ_ONLY = false;

  /* =================================================
     å˜—è©¦è®€å– progress.jsonï¼ˆGitHub Pagesï¼‰
     ================================================= */
  async function loadProgressJSON(){
    try{
      const res = await fetch("progress.json",{cache:"no-store"});
      if(!res.ok) throw new Error();
      const data = await res.json();
      Object.assign(state, data);
      READ_ONLY = true;
      document.getElementById("roBadge").style.display="block";
    }catch{
      READ_ONLY = false;
    }
  }

  /* =================================================
     LocalStorageï¼ˆåªåœ¨éå”¯è®€ï¼‰
     ================================================= */
  function loadLocal(){
    if(READ_ONLY) return;
    const raw = localStorage.getItem(STORAGE_KEY);
    if(raw){
      try{ Object.assign(state, JSON.parse(raw)); }catch{}
    }
  }
  function saveLocal(){
    if(READ_ONLY) return;
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  }

  /* =================================================
     åŒ¯å‡º progress.json
     ================================================= */
  document.getElementById("exportBtn").onclick=()=>{
    const blob = new Blob(
      [JSON.stringify(state,null,2)],
      {type:"application/json"}
    );
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "progress.json";
    a.click();
    URL.revokeObjectURL(a.href);
  };

  /* =================================================
     é–å®šæ‰€æœ‰äº’å‹•
     ================================================= */
  function lockUI(){
    document.querySelectorAll("input,textarea,button").forEach(el=>{
      if(el.id==="exportBtn") return;
      el.disabled=true;
    });
    document.querySelectorAll(".quest,.goal").forEach(el=>{
      el.style.pointerEvents="none";
      el.style.opacity="0.6";
    });
  }

  /* =================================================
     åˆå§‹åŒ–ï¼ˆé †åºå¾ˆé‡è¦ï¼‰
     ================================================= */
  (async function init(){
    await loadProgressJSON();
    loadLocal();

    // âš ï¸ é€™è£¡å‘¼å«ä½ åŸæœ¬ v1.2 çš„ renderAll()
    if(typeof renderAll==="function"){
      renderAll();
    }

    if(READ_ONLY){
      lockUI();
    }
  })();
  </script>
  </body>
  </html>